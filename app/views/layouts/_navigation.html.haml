.navbar.navbar-inverse.navbar-fixed-top
  %nav.navbar-inner
    .container-fluid
      %a.btn.btn-navbar{'data-toggle' => 'collapse', 'data-target' => '.nav-collapse'}
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
      = link_to root_path, :class => 'brand' do
        %span#peacecorps= t 'proper_noun.peace_corps'
        %span#brand-divider= '|'
        %span#brand-locale= ENV['COUNTRY']
      .nav-collapse
        %ul.nav
          %li
            = link_to pages_path do
              %span.icon-list-alt.icon-white
              = t('phrase.site_map').titleize
          %li
            = link_to units_path do
              %span.icon-user.icon-white
              = t('word.for').titleize
              PCVs
          %li
            = link_to work_zones_path do
              %span.icon-user.icon-white
              = t('phrase.for_staff').titleize
          %li.divider-vertical
          %li.dropdown
            %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
              = t 'word.resources'
              %b.caret
            %ul.dropdown-menu
              %li.nav-header= t 'word.things'
              %li
                = link_to pages_path do
                  %span.icon-list-alt
                  = Page.model_name.human(:count => :plural)
              %li.nav-header= ENV['COUNTRY']
              %li= link_to icon_for('unit', Unit.model_name.human(:count => :plural)), units_path if can? :read, Unit
              %li= link_to icon_for('language', Language.model_name.human(:count => :plural)), languages_path if can? :read, Language
              %li= link_to icon_for('region', Region.model_name.human(:count => :plural)), regions_path if can? :read, Region
              %li= link_to icon_for('sector', Sector.model_name.human(:count => :plural)), sectors_path if can? :read, Sector
              %li= link_to icon_for('work_zone', WorkZone.model_name.human(:count => :plural)), work_zones_path if can? :read, WorkZone
              - if signed_in?
                %li.divider
                %li.nav-header= t 'word.people'
                %li= link_to icon_for('user', t('word.everyone')), users_path
                %li= link_to icon_for('staff', Staff.model_name.human(:count => :plural)), staff_index_path
                %li= link_to icon_for('volunteer', Volunteer.model_name.human(:count => :plural)), volunteers_path
                - if user_signed_in? && (current_user.has_role?(:staff) || current_user.has_role?(:volunteer))
                  %li.divider
                  %li.nav-header= t 'proper_noun.peace_corps'
                  - if can? :read, Unit
                    %li
                      = link_to units_path do
                        %span.icon-ok
                        = Unit.model_name.human(:count => :plural)
                  - if can? :read, Stage
                    %li
                      = link_to stages_path do
                        %span.icon-ok
                        = Stage.model_name.human(:count => :plural)
                %li.divider
                %li.nav-header= t 'word.create'
                - if can?(:create, Page)
                  %li
                    = link_to new_page_path do
                      %span.icon-plus
                      = t('phrase.new_resource', :resource => Page.model_name.human).titleize
          -# initiatives
          -#%li.dropdown
            %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
              Initiatives
              %b.caret
            %ul.dropdown-menu
              - if signed_in? && can?(:create, Initiative)
                %li
                  = link_to new_initiative_path do
                    %span.icon-plus
                    New Initiative
                %li.divider
              %li
                = link_to initiatives_path do
                  %span.icon-globe
                  Overview Map
              %li.divider
              - for initiative in Initiative.all do
                %li= link_to initiative.name, initiative
        -# user menu
        %ul.nav.pull-right
          - if user_signed_in?
            - if current_user.has_role?(:moderator) || current_user.has_role?(:admin)
              %li.dropdown
                %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
                  = t('word.manage').titleize
                  %b.caret
                %ul.dropdown-menu.pull-right
                  %li
                    = link_to valid_emails_path do
                      %span.icon-envelope
                      = ValidEmail.model_name.human(:count => :plural)
                  %li
                    = link_to new_valid_email_path do
                      %span.icon-plus
                      = t 'word.add'
                      = ValidEmail.model_name.human(:count => :plural)
            %li.dropdown
              %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
                = current_user.name
                %b.caret
              %ul.dropdown-menu.pull-right
                %li
                  = link_to current_user do
                    %span.icon-user
                    = t('word.profile')
                %li.divider
                %li
                  = link_to edit_user_registration_path do
                    %span.icon-wrench
                    = t('phrase.edit_resource', :resource => t('word.profile')).titleize
                %li
                  = link_to destroy_user_session_path, :method=>'delete' do
                    %span.icon-remove
                    = t('phrase.sign_out').titleize
          - else
            %li.dropdown
              %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
                Sign in
                %b.caret
              %ul.dropdown-menu.pull-right
                %li
                  = link_to new_user_session_path do
                    %span.icon-arrow-right
                    Sign in
                %li
                  = link_to user_omniauth_authorize_path(:facebook) do
                    %span.icon-arrow-right
                    Sign in with Facebook
                %li
                  = link_to new_user_registration_path do
                    %span.icon-plus
                    Sign up
        -# country / initiative / page edit indicator
        %ul.nav.pull-right
          -# if @country
            %li= link_to (raw('<span class="icon-globe icon-white"></span>')), countries_path, :rel => 'tooltip', 'data-placement' => 'bottom', :title => "you're in a country"
          -# if @initiative
            %li= link_to (raw('<span class="icon-flag icon-white"></span>')), initiatives_path, :rel => 'tooltip', 'data-placement' => 'bottom', :title => "you're in an initiative"
          - if signed_in?
            - if @page && !@page.new_record?
              %li.divider-vertical
                %li= link_to raw('<span class="icon-lock icon-white"></span>&nbsp;'), @page, :rel => 'tooltip', :title => "#{@page.editor.name} is editing", 'data-placement' => 'bottom' if @page.locked?
              %li= link_to raw('<span class="icon-pencil icon-white"></span>'), edit_page_path(@page), :rel => 'tooltip', 'data-placement' => 'bottom', :title => "available to edit" unless @page.locked?
          %li.divider-vertical
        -# search form
        = form_tag search_index_path, :method => :get, :class => 'navbar-search pull-right' do
          = text_field_tag 'q', nil, :class => 'search-query', 'placeholder' => t('word.search')
