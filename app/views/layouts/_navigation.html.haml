.navbar.navbar-inverse.navbar-fixed-top
  %nav.navbar-inner
    .container-fluid
      %a.btn.btn-navbar{'data-toggle' => 'collapse', 'data-target' => '.nav-collapse'}
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
      = link_to root_path, :class => 'brand' do
        %span#peacecorps Peace Corps
        %span#brand-divider= '|'
        %span#brand-locale= ENV['COUNTRY']
      .nav-collapse
        %ul.nav
          %li
            = link_to pages_path do
              %span.icon-list-alt.icon-white
              Site Map
          %li
            = link_to units_path do
              %span.icon-user.icon-white
              For PCVs
          %li
            = link_to units_path do
              %span.icon-user.icon-white
              For Staff
          %li.divider-vertical
          %li.dropdown
            %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
              Resources
              %b.caret
            %ul.dropdown-menu
              %li.nav-header Things
              %li
                = link_to pages_path do
                  %span.icon-list-alt
                  Pages
              - if signed_in?
                %li.divider
                %li.nav-header People
                %li
                  = link_to users_path do
                    %span.icon-user
                    Everyone
                %li
                  = link_to staff_index_path do
                    %span.icon-user
                    Staff
                %li
                  = link_to volunteers_path do
                    %span.icon-user
                    Volunteers
                %li.divider
                %li.nav-header Create
                - if can?(:create, Page)
                  %li
                    = link_to new_page_path do
                      %span.icon-plus
                      New Page
          -# initiatives
          -#%li.dropdown
            %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
              Initiatives
              %b.caret
            %ul.dropdown-menu
              - if signed_in? && can?(:create, Initiative)
                %li
                  = link_to new_initiative_path do
                    %span.icon-plus
                    New Initiative
                %li.divider
              %li
                = link_to initiatives_path do
                  %span.icon-globe
                  Overview Map
              %li.divider
              - for initiative in Initiative.all do
                %li= link_to initiative.name, initiative
        -# user menu
        %ul.nav.pull-right
          - if user_signed_in?
            - if current_user.has_role?(:moderator) || current_user.has_role?(:admin)
              %li.dropdown
                %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
                  Manage
                  %b.caret
                %ul.dropdown-menu.pull-right
                  %li
                    = link_to valid_emails_path do
                      %span.icon-envelope
                      Valid Emails
                  %li
                    = link_to new_valid_email_path do
                      %span.icon-plus
                      Add Valid Emails
            %li.dropdown
              %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
                = current_user.name
                %b.caret
              %ul.dropdown-menu.pull-right
                %li
                  = link_to current_user do
                    %span.icon-user
                    Profile
                %li.divider
                %li
                  = link_to edit_user_registration_path do
                    %span.icon-wrench
                    Edit account
                %li
                  = link_to destroy_user_session_path, :method=>'delete' do
                    %span.icon-remove
                    Sign out
          - else
            %li.dropdown
              %a.dropdown-toggle{'href' => '#', 'data-toggle' => 'dropdown'}
                Sign in
                %b.caret
              %ul.dropdown-menu.pull-right
                %li
                  = link_to new_user_session_path do
                    %span.icon-arrow-right
                    Sign in
                %li
                  = link_to user_omniauth_authorize_path(:facebook) do
                    %span.icon-arrow-right
                    Sign in with Facebook
                %li
                  = link_to new_user_registration_path do
                    %span.icon-plus
                    Sign up
        -# country / initiative / page edit indicator
        %ul.nav.pull-right
          -# if @country
            %li= link_to (raw('<span class="icon-globe icon-white"></span>')), countries_path, :rel => 'tooltip', 'data-placement' => 'bottom', :title => "you're in a country"
          -# if @initiative
            %li= link_to (raw('<span class="icon-flag icon-white"></span>')), initiatives_path, :rel => 'tooltip', 'data-placement' => 'bottom', :title => "you're in an initiative"
          - if signed_in?
            - if @page && !@page.new_record?
              %li.divider-vertical
                %li= link_to raw('<span class="icon-lock icon-white"></span>&nbsp;'), @page, :rel => 'tooltip', :title => "#{@page.editor.name} is editing", 'data-placement' => 'bottom' if @page.locked?
              %li= link_to raw('<span class="icon-pencil icon-white"></span>'), edit_page_path(@page), :rel => 'tooltip', 'data-placement' => 'bottom', :title => "available to edit" unless @page.locked?
          %li.divider-vertical
        -# search form
        = form_tag search_path, :method => :get, :class => 'navbar-search pull-right' do
          = text_field_tag 'q', nil, :class => 'search-query', 'placeholder' => 'search'
